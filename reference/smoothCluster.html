<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function smoothCluster replace the previous function name fitINLA2 (before version 1.0.0)."><title>Cluster-level space-time smoothing models for mortality rates — smoothCluster • SUMMER</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cluster-level space-time smoothing models for mortality rates — smoothCluster"><meta property="og:description" content="The function smoothCluster replace the previous function name fitINLA2 (before version 1.0.0)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SUMMER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/web_only/small-area-estimation.html">Generic small area estimation</a>
    <a class="dropdown-item" href="../articles/web_only/u5mr-vignette.html">Estimating Subnational U5MR using Simulated Data</a>
    <a class="dropdown-item" href="../articles/web_only/u5mr-dhs-vignette.html">Estimating Subnational U5MR using DHS Data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/richardli/SUMMER/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Cluster-level space-time smoothing models for mortality rates</h1>
      <small class="dont-index">Source: <a href="https://github.com/richardli/SUMMER/blob/HEAD/R/fitINLA2.R" class="external-link"><code>R/fitINLA2.R</code></a></small>
      <div class="d-none name"><code>smoothCluster.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>smoothCluster</code> replace the previous function name <code>fitINLA2</code> (before version 1.0.0).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smoothCluster</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"betabinomial"</span>, <span class="st">"binomial"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  age.groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1-11"</span>, <span class="st">"12-23"</span>, <span class="st">"24-35"</span>, <span class="st">"36-47"</span>, <span class="st">"48-59"</span><span class="op">)</span>,</span>
<span>  age.n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  age.time.group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  age.strata.fixed.group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  time.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rw1"</span>, <span class="st">"rw2"</span>, <span class="st">"ar1"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  st.time.model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">Amat</span>,</span>
<span>  bias.adj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bias.adj.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">year_label</span>,</span>
<span>  type.st <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  survey.effect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  linear.trend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  common.trend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strata.time.effect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hyper <span class="op">=</span> <span class="st">"pc"</span>,</span>
<span>  pc.u <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pc.alpha <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  pc.u.phi <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pc.alpha.phi <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  pc.u.cor <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  pc.alpha.cor <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  pc.st.u <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  pc.st.alpha <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  pc.st.slope.u <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  pc.st.slope.alpha <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  overdisp.mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  overdisp.prec <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>config <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  control.inla <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>strategy <span class="op">=</span> <span class="st">"adaptive"</span>, int.strategy <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span>,</span>
<span>  control.fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  geo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rw <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  st.rw <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  age.rw.group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fitINLA2</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"betabinomial"</span>, <span class="st">"binomial"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  age.groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1-11"</span>, <span class="st">"12-23"</span>, <span class="st">"24-35"</span>, <span class="st">"36-47"</span>, <span class="st">"48-59"</span><span class="op">)</span>,</span>
<span>  age.n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  age.time.group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  age.strata.fixed.group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  time.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rw1"</span>, <span class="st">"rw2"</span>, <span class="st">"ar1"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  st.time.model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">Amat</span>,</span>
<span>  bias.adj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bias.adj.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">year_label</span>,</span>
<span>  type.st <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  survey.effect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  linear.trend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  common.trend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strata.time.effect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hyper <span class="op">=</span> <span class="st">"pc"</span>,</span>
<span>  pc.u <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pc.alpha <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  pc.u.phi <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pc.alpha.phi <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  pc.u.cor <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  pc.alpha.cor <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  pc.st.u <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  pc.st.alpha <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  pc.st.slope.u <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  pc.st.slope.alpha <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  overdisp.mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  overdisp.prec <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>config <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  control.inla <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>strategy <span class="op">=</span> <span class="st">"adaptive"</span>, int.strategy <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span>,</span>
<span>  control.fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  geo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rw <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  st.rw <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  age.rw.group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>count data of person-months with the following columns</p><ul><li><p>cluster: cluster ID</p></li>
<li><p>years: time period</p></li>
<li><p>region: region of the cluster</p></li>
<li><p>strata: stratum of the cluster</p></li>
<li><p>age: age group corresponding to the row</p></li>
<li><p>total: total number of person-month in this age group, stratum, cluster, and period</p></li>
<li><p>Y: total number of deaths in this age group, stratum, cluster, and period</p></li>
</ul></dd>


<dt>X</dt>
<dd><p>Covariate matrix. It must contain either a column with name "region", or a column with name "years", or both. The covariates must not have missing values for all regions (if varying in space) and all time periods (if varying in time). The rest of the columns are treated as covariates in the mean model.</p></dd>


<dt>family</dt>
<dd><p>family of the model. This can be either binomial (with logistic normal prior), betabiniomial.</p></dd>


<dt>age.groups</dt>
<dd><p>a character vector of age groups in increasing order.</p></dd>


<dt>age.n</dt>
<dd><p>number of months in each age groups in the same order.</p></dd>


<dt>age.time.group</dt>
<dd><p>vector indicating grouping of the ages groups in the temporal model. For example, if each age group is assigned a different temporal component, then set age.rw.group to c(1:length(age.groups)); if all age groups share the same random walk component, then set age.rw.group to a rep(1, length(age.groups)). The default for 6 age groups is c(1,2,3,3,3,3), which assigns a separate temporal trend to the first two groups and a common random walk for the rest of the age groups. The vector should contain values starting from 1. This argument replaces the previous <code>age.rw.group</code> argument.</p></dd>


<dt>age.strata.fixed.group</dt>
<dd><p>vector indicating grouping of the ages groups for different strata in the intercept. The default is c(1:length(age.groups)), which correspond to each age group within each stratum receives a separate intercept. If several age groups are specified to be the same value in this vector, the stratum specific deviation from the baseline is assumed to be the same for these age groups. For example, if <code>age.strata.fixed.group = c(1, 2, 3, 3, 3, 3)</code>, then the intercept part of the linear predictor consists of 6 overall age-specific intercepts and 3 set of strata effects (where a base stratum is chosen internally), for age groups 1, 2, and the rest respectively. Notice that this argument does not control the linear temporal trends (which is also parameterized as fixed effect, but determined by the <code>age.rw.group</code> argument). The vector should contain values starting from 1.</p>
<p>More specific examples: (1) if each age group is assigned a different intercept, then set age.strata.fixed.group to c(1:length(age.groups)) (2) if all age groups share the same intercept, then set age.strata.fixed.group to a rep(1, length(age.groups)). The default for 6 age groups is the former. (3) If each temporal trend is associated with its own intercept, set it to be the same as <code>age.rw.group</code>.</p></dd>


<dt>time.model</dt>
<dd><p>Model for the main temporal trend, can be rw1, rw2, ar1, or NULL (for spatial-only smoothing). Default to be rw2. For ar1 main effect, a linear slope is also added with time scaled to be between -0.5 to 0.5, i.e., the slope coefficient represents the total change between the first year and the last year in the projection period on the logit scale.</p></dd>


<dt>st.time.model</dt>
<dd><p>Temporal component model for the interaction term, can be rw1, rw2, or ar1. Default to be the same as time.model unless specified otherwise. The default does not include region-specific random slopes. They can be added to the interaction term by specifying <code>pc.st.slope.u</code> and <code>pc.st.slope.alpha</code>.</p></dd>


<dt>Amat</dt>
<dd><p>Adjacency matrix for the regions</p></dd>


<dt>bias.adj</dt>
<dd><p>the ratio of unadjusted mortality rates or age-group-specific hazards to the true rates or hazards. It needs to be a data frame that can be merged to thee outcome, i.e., with the same column names for time periods (for national adjustment), or time periods and region (for subnational adjustment). The column specifying the adjustment ratio should be named "ratio".</p></dd>


<dt>bias.adj.by</dt>
<dd><p>vector of the column names specifying how to merge the bias adjustment to the count data. For example, if bias adjustment factor is provided in bias.adj for each region and time, then bias.adj.by should be `c("region", "time")`.</p></dd>


<dt>formula</dt>
<dd><p>INLA formula.  See vignette for example of using customized formula.</p></dd>


<dt>year_label</dt>
<dd><p>string vector of year names</p></dd>


<dt>type.st</dt>
<dd><p>type for space-time interaction</p></dd>


<dt>survey.effect</dt>
<dd><p>logical indicator whether to include a survey fixed effect. If this is set to TRUE, there needs to be a column named 'survey' in the input data frame. In prediction, this effect term will be set to 0.</p></dd>


<dt>linear.trend</dt>
<dd><p>logical indicator whether a linear trend is added to the temporal main effect. If the temporal main effect is RW2, then it will be forced to FALSE. Default is TRUE.</p></dd>


<dt>common.trend</dt>
<dd><p>logical indicator whether all age groups and strata share the same linear trend in the temporal main effect.</p></dd>


<dt>strata.time.effect</dt>
<dd><p>logical indicator whether to include strata specific temporal trends.</p></dd>


<dt>hyper</dt>
<dd><p>Deprecated. which hyperpriors to use. Only supports PC prior ("pc").</p></dd>


<dt>pc.u</dt>
<dd><p>hyperparameter U for the PC prior on precisions.</p></dd>


<dt>pc.alpha</dt>
<dd><p>hyperparameter alpha for the PC prior on precisions.</p></dd>


<dt>pc.u.phi</dt>
<dd><p>hyperparameter U for the PC prior on the mixture probability phi in BYM2 model.</p></dd>


<dt>pc.alpha.phi</dt>
<dd><p>hyperparameter alpha for the PC prior on the mixture probability phi in BYM2 model.</p></dd>


<dt>pc.u.cor</dt>
<dd><p>hyperparameter U for the PC prior on the autocorrelation parameter in the AR prior, i.e. Prob(cor &gt; pc.u.cor) = pc.alpha.cor.</p></dd>


<dt>pc.alpha.cor</dt>
<dd><p>hyperparameter alpha for the PC prior on the autocorrelation parameter in the AR prior.</p></dd>


<dt>pc.st.u</dt>
<dd><p>hyperparameter U for the PC prior on precisions for the interaction term.</p></dd>


<dt>pc.st.alpha</dt>
<dd><p>hyperparameter alpha for the PC prior on precisions for the interaction term.</p></dd>


<dt>pc.st.slope.u</dt>
<dd><p>hyperparameter U for the PC prior on precisions for the area-level random slope. If both pc.st.slope.u and pc.st.slope.alpha are not NA, an area-level random slope with iid prior will be added to the model. The parameterization of the random slope is so that Prob(|beta| &gt; pc.st.slope.u) = pc.st.slope.alpha, where time covariate is rescaled to be -0.5 to 0.5, so that the random slope can be interpreted as the total deviation from the main trend from the first year to the last year to be projected, on the logit scale.</p></dd>


<dt>pc.st.slope.alpha</dt>
<dd><p>hyperparameter alpha for the PC prior on precisions for the area-level random slope. See above for the parameterization.</p></dd>


<dt>overdisp.mean</dt>
<dd><p>hyperparameter for the betabinomial likelihood. Mean of the over-dispersion parameter on the logit scale.</p></dd>


<dt>overdisp.prec</dt>
<dd><p>hyperparameter for the betabinomial likelihood. Precision of the over-dispersion parameter on the logit scale.</p></dd>


<dt>options</dt>
<dd><p>list of options to be passed to control.compute() in the inla() function.</p></dd>


<dt>control.inla</dt>
<dd><p>list of options to be passed to control.inla() in the inla() function. Default to the "adaptive" integration strategy.</p></dd>


<dt>control.fixed</dt>
<dd><p>list of options to be passed to control.fixed() in the inla() function.</p></dd>


<dt>verbose</dt>
<dd><p>logical indicator to print out detailed inla() intermediate steps.</p></dd>


<dt>geo</dt>
<dd><p>Deprecated. Spatial polygon file, legacy parameter from previous versions of the package.</p></dd>


<dt>rw</dt>
<dd><p>Deprecated. Take values 0, 1 or 2, indicating the order of random walk. If rw = 0, the autoregressive process is used instead of the random walk in the main trend. See the description of the argument ar for details.</p></dd>


<dt>ar</dt>
<dd><p>Deprecated. Order of the autoregressive component. If ar is specified to be positive integer, the random walk components will be replaced by AR(p) terms in the interaction part. The main temporal trend remains to be random walk of order rw unless rw = 0.</p></dd>


<dt>st.rw</dt>
<dd><p>Deprecated. Take values 1 or 2, indicating the order of random walk for the interaction term. If not specified, it will take the same order as the argument rw in the main effect. Notice that this argument is only used if ar is set to 0.</p></dd>


<dt>age.rw.group</dt>
<dd><p>Deprecated. Legacy parameter replaced by <code>age.time.group</code>.</p></dd>


<dt>...</dt>
<dd><p>arguments to be passed to the inla() function call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>INLA model fit using the provided formula, country summary data, and geographic data</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="getDirect.html">getDirect</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Zehang Richard Li</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Create dataset of counts</span></span></span>
<span class="r-in"><span><span class="va">counts.all</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="getCounts.html">getCounts</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"clustid"</span>, <span class="st">"time"</span>, <span class="st">"age"</span>, <span class="st">"died"</span>,</span></span>
<span class="r-in"><span>                                        <span class="st">"region"</span>, <span class="st">"strata"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            variables <span class="op">=</span> <span class="st">'died'</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"clustid"</span>, <span class="st">"region"</span>, </span></span>
<span class="r-in"><span>                                         <span class="st">"time"</span>, <span class="st">"strata"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="va">clustid</span>, years <span class="op">=</span> <span class="va">time</span>, Y<span class="op">=</span><span class="va">died</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">counts</span><span class="op">$</span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*\\."</span>,<span class="st">""</span>,<span class="va">counts</span><span class="op">$</span><span class="va">strata</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">counts</span><span class="op">$</span><span class="va">survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> </span></span>
<span class="r-in"><span>  <span class="va">counts.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">counts.all</span>, <span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cluster-level model on the periods</span></span></span>
<span class="r-in"><span><span class="va">periods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">smoothCluster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts.all</span>, </span></span>
<span class="r-in"><span>     Amat <span class="op">=</span> <span class="va">DemoMap</span><span class="op">$</span><span class="va">Amat</span>, </span></span>
<span class="r-in"><span>     time.model <span class="op">=</span> <span class="st">"rw2"</span>, </span></span>
<span class="r-in"><span>     st.time.model <span class="op">=</span> <span class="st">"rw1"</span>,</span></span>
<span class="r-in"><span>     strata.time.effect <span class="op">=</span>  <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>     survey.effect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     family <span class="op">=</span> <span class="st">"betabinomial"</span>,</span></span>
<span class="r-in"><span>     year_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">periods</span>, <span class="st">"15-19"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSmoothed.html">getSmoothed</a></span><span class="op">(</span><span class="va">fit</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">stratified</span>, plot.CI<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">strata</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cluster-level space-time model with covariate</span></span></span>
<span class="r-in"><span><span class="co"># notice without projected covariates, we use periods up to 10-14 only</span></span></span>
<span class="r-in"><span><span class="co"># construct a random covariate matrix for illustration</span></span></span>
<span class="r-in"><span><span class="va">periods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>years <span class="op">=</span> <span class="va">periods</span>, </span></span>
<span class="r-in"><span>       region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">counts.all</span><span class="op">$</span><span class="va">region</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">$</span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">$</span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.covariate</span> <span class="op">&lt;-</span> <span class="fu">smoothCluster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts.all</span>, </span></span>
<span class="r-in"><span>   X <span class="op">=</span> <span class="va">X</span>,</span></span>
<span class="r-in"><span>     Amat <span class="op">=</span> <span class="va">DemoMap</span><span class="op">$</span><span class="va">Amat</span>, </span></span>
<span class="r-in"><span>     time.model <span class="op">=</span> <span class="st">"rw2"</span>, </span></span>
<span class="r-in"><span>     st.time.model <span class="op">=</span> <span class="st">"rw1"</span>,</span></span>
<span class="r-in"><span>     strata.time.effect <span class="op">=</span>  <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>     survey.effect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     family <span class="op">=</span> <span class="st">"betabinomial"</span>,</span></span>
<span class="r-in"><span>     year_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">periods</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSmoothed.html">getSmoothed</a></span><span class="op">(</span><span class="va">fit.covariate</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cluster-level model for one time point only</span></span></span>
<span class="r-in"><span><span class="co"># i.e., space-only model</span></span></span>
<span class="r-in"><span><span class="va">fit.sp</span> <span class="op">&lt;-</span> <span class="fu">smoothCluster</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">counts.all</span>, <span class="va">time</span> <span class="op">==</span> <span class="st">"10-14"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>     Amat <span class="op">=</span> <span class="va">DemoMap</span><span class="op">$</span><span class="va">Amat</span>, </span></span>
<span class="r-in"><span>     time.model <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>     survey.effect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     family <span class="op">=</span> <span class="st">"betabinomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.sp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSmoothed.html">getSmoothed</a></span><span class="op">(</span><span class="va">fit.sp</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">stratified</span>, plot.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">strata</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit cluster-level model for one time point and covariate</span></span></span>
<span class="r-in"><span><span class="co"># construct a random covariate matrix for illustration</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">counts.all</span><span class="op">$</span><span class="va">region</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>      X2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.sp.covariate</span> <span class="op">&lt;-</span> <span class="fu">smoothCluster</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">counts.all</span>, <span class="va">time</span> <span class="op">==</span> <span class="st">"10-14"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>     X <span class="op">=</span> <span class="va">X</span>, </span></span>
<span class="r-in"><span>     Amat <span class="op">=</span> <span class="va">DemoMap</span><span class="op">$</span><span class="va">Amat</span>, </span></span>
<span class="r-in"><span>     time.model <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>     survey.effect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     family <span class="op">=</span> <span class="st">"betabinomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.sp.covariate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSmoothed.html">getSmoothed</a></span><span class="op">(</span><span class="va">fit.sp.covariate</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zehang R Li, Bryan D Martin, Yuan Hsiao, Jessica Godwin, John Paige, Peter Gao, Jon Wakefield, Samuel J Clark, Geir-Arne Fuglstad, Andrea Riebler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

