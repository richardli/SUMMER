<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Benchmark posterior draws to national estimates — Benchmark • SUMMER</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Benchmark posterior draws to national estimates — Benchmark"><meta name="description" content=""><meta property="og:description" content=""></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SUMMER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/web_only/small-area-estimation.html">Generic small area estimation</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/u5mr-vignette.html">Estimating Subnational U5MR using Simulated Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/u5mr-dhs-vignette.html">Estimating Subnational U5MR using DHS Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/cluster-model-vignette.html">Specifying cluster-level model for mortality estimation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/richardli/SUMMER/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Benchmark posterior draws to national estimates</h1>
      <small class="dont-index">Source: <a href="https://github.com/richardli/SUMMER/blob/master/R/benchmark.R" class="external-link"><code>R/benchmark.R</code></a></small>
      <div class="d-none name"><code>Benchmark.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Benchmark</span><span class="op">(</span></span>
<span>  <span class="va">fitted</span>,</span>
<span>  <span class="va">national</span>,</span>
<span>  <span class="va">estVar</span>,</span>
<span>  <span class="va">sdVar</span>,</span>
<span>  timeVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weight.region <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MH"</span>, <span class="st">"Rejection"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fitted">fitted<a class="anchor" aria-label="anchor" href="#arg-fitted"></a></dt>
<dd><p>output from <code><a href="getSmoothed.html">getSmoothed</a></code> to be benchmarked.</p></dd>


<dt id="arg-national">national<a class="anchor" aria-label="anchor" href="#arg-national"></a></dt>
<dd><p>a data frame of national level estimates that is benchmarked against, with at least two columns indicating national estimates (probability scale) and the associated standard error. If benchmarking over multiple time period, a third column indicating time period is needed.</p></dd>


<dt id="arg-estvar">estVar<a class="anchor" aria-label="anchor" href="#arg-estvar"></a></dt>
<dd><p>column name in <code>national</code> that indicates national estimates.</p></dd>


<dt id="arg-sdvar">sdVar<a class="anchor" aria-label="anchor" href="#arg-sdvar"></a></dt>
<dd><p>column name in <code>national</code> that indicates standard errors of national estimates.</p></dd>


<dt id="arg-timevar">timeVar<a class="anchor" aria-label="anchor" href="#arg-timevar"></a></dt>
<dd><p>column name in <code>national</code> that indicates time periods.</p></dd>


<dt id="arg-weight-region">weight.region<a class="anchor" aria-label="anchor" href="#arg-weight-region"></a></dt>
<dd><p>a data frame with a column <code>region</code> specifying subnational regions, a column <code>proportion</code> that specifies the proportion of population in each region. When multiple time periods exist, a third column <code>years</code> is required and the population proportions are the population proportions of each region in the corresponding time period.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a string denoting the algorithm to use for benchmarking. Options include <code>MH</code> for Metropolis-Hastings, and <code>Rejection</code> for rejection sampler. Defaults to <code>Rejection</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Benchmarked object in S3 class SUMMERproj or SUMMERprojlist in the same format as the input object <code>fitted</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Okonek, Taylor, and Jon Wakefield. "A computationally efficient approach to fully Bayesian benchmarking." Journal of Official Statistics 40, no. 2 (2024): 283-316.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Taylor Okonek, Zehang Richard Li</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">##  ------------------------------------------ ##</span></span></span>
<span class="r-in"><span><span class="co">##     Benchmarking with smoothCluster output</span></span></span>
<span class="r-in"><span><span class="co">##  ------------------------------------------ ##</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># fit unstratified cluster-level model</span></span></span>
<span class="r-in"><span><span class="va">counts.all</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"clustid"</span>, <span class="st">"region"</span>, <span class="st">"time"</span>, <span class="st">"age"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="getCounts.html">getCounts</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vars</span>, <span class="st">"died"</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>            variables <span class="op">=</span> <span class="st">'died'</span>,</span></span>
<span class="r-in"><span>             by <span class="op">=</span> <span class="va">vars</span>, drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">counts</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">counts</span><span class="op">$</span><span class="va">clustid</span></span></span>
<span class="r-in"><span><span class="va">counts</span><span class="op">$</span><span class="va">years</span> <span class="op">&lt;-</span> <span class="va">counts</span><span class="op">$</span><span class="va">time</span></span></span>
<span class="r-in"><span><span class="va">counts</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">counts</span><span class="op">$</span><span class="va">died</span></span></span>
<span class="r-in"><span><span class="va">counts</span><span class="op">$</span><span class="va">survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  </span></span>
<span class="r-in"><span><span class="va">counts.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">counts.all</span>, <span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">periods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"85-89"</span>, <span class="st">"90-94"</span>, <span class="st">"95-99"</span>, <span class="st">"00-04"</span>, <span class="st">"05-09"</span>, <span class="st">"10-14"</span>, <span class="st">"15-19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.bb</span>  <span class="op">&lt;-</span> <span class="fu"><a href="smoothCluster.html">smoothCluster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts.all</span>, Amat <span class="op">=</span> <span class="va">DemoMap</span><span class="op">$</span><span class="va">Amat</span>, </span></span>
<span class="r-in"><span>        family <span class="op">=</span> <span class="st">"betabinomial"</span>,</span></span>
<span class="r-in"><span>        year.label <span class="op">=</span> <span class="va">periods</span>, </span></span>
<span class="r-in"><span>        survey.effect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est.bb</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSmoothed.html">getSmoothed</a></span><span class="op">(</span><span class="va">fit.bb</span>, nsim <span class="op">=</span> <span class="fl">1e4</span>, CI <span class="op">=</span> <span class="fl">0.95</span>, save.draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># construct a simple population weight data frame with equal weights</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">counts.all</span><span class="op">$</span><span class="va">region</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             years <span class="op">=</span> <span class="va">periods</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span><span class="op">$</span><span class="va">proportion</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># construct a simple national estimates</span></span></span>
<span class="r-in"><span><span class="va">national</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>years <span class="op">=</span> <span class="va">periods</span>, </span></span>
<span class="r-in"><span>           est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.27</span>, <span class="fl">0.1</span>, length <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>           sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># benchmarking</span></span></span>
<span class="r-in"><span><span class="va">est.bb.bench</span> <span class="op">&lt;-</span> <span class="fu">Benchmark</span><span class="op">(</span><span class="va">est.bb</span>, <span class="va">national</span>, weight.region <span class="op">=</span> <span class="va">weight.region</span>, </span></span>
<span class="r-in"><span>            estVar <span class="op">=</span> <span class="st">"est"</span>, sdVar <span class="op">=</span> <span class="st">"sd"</span>, timeVar <span class="op">=</span> <span class="st">"years"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sanity check: Benchmarking comparison</span></span></span>
<span class="r-in"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="va">national</span></span></span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">before</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">after</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">weight.region</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb</span><span class="op">$</span><span class="va">overall</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sub</span>, <span class="va">weights</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb.bench</span><span class="op">$</span><span class="va">overall</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sub.bench</span>, <span class="va">weights</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">compare</span><span class="op">$</span><span class="va">before</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">proportion</span> <span class="op">*</span> <span class="va">sub</span><span class="op">$</span><span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sub.bench</span><span class="op">$</span><span class="va">proportion</span> <span class="op">*</span> <span class="va">sub.bench</span><span class="op">$</span><span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"External national estimates"</span>, </span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"Weighted posterior median after benchmarking"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Sanity check: weighted average of area medians"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before benchmarking"</span>, <span class="st">"After benchmarking"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  construct a simple national estimates</span></span></span>
<span class="r-in"><span><span class="va">national</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>years <span class="op">=</span> <span class="va">periods</span>, </span></span>
<span class="r-in"><span>             est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.22</span>, <span class="fl">0.1</span>, length <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># national does not need to have all years</span></span></span>
<span class="r-in"><span><span class="va">national_sub</span> <span class="op">&lt;-</span> <span class="va">national</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># benchmarking</span></span></span>
<span class="r-in"><span><span class="va">est.bb.bench</span> <span class="op">&lt;-</span> <span class="fu">Benchmark</span><span class="op">(</span><span class="va">est.bb</span>, <span class="va">national_sub</span>, </span></span>
<span class="r-in"><span>            weight.region <span class="op">=</span> <span class="va">weight.region</span>, </span></span>
<span class="r-in"><span>            estVar <span class="op">=</span> <span class="st">"est"</span>, sdVar <span class="op">=</span> <span class="st">"sd"</span>, timeVar <span class="op">=</span> <span class="st">"years"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sanity check: only benchmarked for three periods</span></span></span>
<span class="r-in"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="va">national</span></span></span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">before</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">after</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">weight.region</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb</span><span class="op">$</span><span class="va">overall</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sub</span>, <span class="va">weights</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb.bench</span><span class="op">$</span><span class="va">overall</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sub.bench</span>, <span class="va">weights</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">compare</span><span class="op">$</span><span class="va">before</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">proportion</span> <span class="op">*</span> <span class="va">sub</span><span class="op">$</span><span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sub.bench</span><span class="op">$</span><span class="va">proportion</span> <span class="op">*</span> <span class="va">sub.bench</span><span class="op">$</span><span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"External national estimates"</span>, </span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"Weighted posterior median after benchmarking"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Sanity check: weighted average of area medians"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before benchmarking"</span>, <span class="st">"After benchmarking"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  Another extreme benchmarking example, where almost all weights in central region</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span><span class="op">$</span><span class="va">proportion</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span><span class="op">$</span><span class="va">proportion</span><span class="op">[</span><span class="va">weight.region</span><span class="op">$</span><span class="va">region</span> <span class="op">==</span> <span class="st">"central"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.97</span></span></span>
<span class="r-in"><span><span class="co"># benchmarking</span></span></span>
<span class="r-in"><span><span class="va">est.bb.bench</span> <span class="op">&lt;-</span> <span class="fu">Benchmark</span><span class="op">(</span><span class="va">est.bb</span>, <span class="va">national</span>, weight.region <span class="op">=</span> <span class="va">weight.region</span>, </span></span>
<span class="r-in"><span>          estVar <span class="op">=</span> <span class="st">"est"</span>, sdVar <span class="op">=</span> <span class="st">"sd"</span>, timeVar <span class="op">=</span> <span class="st">"years"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># It can be seen the central region are pulled to the national benchmark</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb.bench</span><span class="op">$</span><span class="va">overall</span>, <span class="va">region</span> <span class="op">==</span> <span class="st">"central"</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span>,</span></span>
<span class="r-in"><span>   col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">10</span>, xlab <span class="op">=</span> <span class="st">"External national estimates"</span>, </span></span>
<span class="r-in"><span>   ylab <span class="op">=</span> <span class="st">"Central region estimates"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb</span><span class="op">$</span><span class="va">overall</span>, <span class="va">region</span> <span class="op">==</span> <span class="st">"central"</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before benchmarking"</span>, <span class="st">"After benchmarking"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with the MH method</span></span></span>
<span class="r-in"><span><span class="co"># Benchmarking with MH should be applied when customized priors are </span></span></span>
<span class="r-in"><span><span class="co">#  specified for fixed effects when fitting the model</span></span></span>
<span class="r-in"><span><span class="va">fit.bb.new</span>  <span class="op">&lt;-</span> <span class="fu"><a href="smoothCluster.html">smoothCluster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts.all</span>, Amat <span class="op">=</span> <span class="va">DemoMap</span><span class="op">$</span><span class="va">Amat</span>, </span></span>
<span class="r-in"><span>        family <span class="op">=</span> <span class="st">"betabinomial"</span>,</span></span>
<span class="r-in"><span>        year.label <span class="op">=</span> <span class="va">periods</span>, </span></span>
<span class="r-in"><span>        survey.effect <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>        control.fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>          mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>`age.intercept0:1`<span class="op">=</span><span class="op">-</span><span class="fl">4</span>, </span></span>
<span class="r-in"><span>                   `age.intercept1-11:1`<span class="op">=</span><span class="op">-</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>                   `age.intercept12-23:1`<span class="op">=</span><span class="op">-</span><span class="fl">8</span>,</span></span>
<span class="r-in"><span>                   `age.intercept24-35:1`<span class="op">=</span><span class="op">-</span><span class="fl">9</span>,</span></span>
<span class="r-in"><span>                   `age.intercept36-47:1`<span class="op">=</span><span class="op">-</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   `age.intercept48-59:1`<span class="op">=</span><span class="op">-</span><span class="fl">11</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>          prec<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>`age.intercept0:1`<span class="op">=</span><span class="fl">10</span>, </span></span>
<span class="r-in"><span>                   `age.intercept1-11:1`<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   `age.intercept12-23:1`<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   `age.intercept24-35:1`<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   `age.intercept36-47:1`<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   `age.intercept48-59:1`<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est.bb.new</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSmoothed.html">getSmoothed</a></span><span class="op">(</span><span class="va">fit.bb.new</span>, nsim <span class="op">=</span> <span class="fl">10000</span>, CI <span class="op">=</span> <span class="fl">0.95</span>, save.draws<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  construct a simple national estimates</span></span></span>
<span class="r-in"><span><span class="va">national</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>years <span class="op">=</span> <span class="va">periods</span>, </span></span>
<span class="r-in"><span>             est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.22</span>, <span class="fl">0.1</span>, length <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">counts.all</span><span class="op">$</span><span class="va">region</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             years <span class="op">=</span> <span class="va">periods</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span><span class="op">$</span><span class="va">proportion</span> <span class="op">&lt;-</span> <span class="fl">0.25</span>             </span></span>
<span class="r-in"><span><span class="va">est.bb.bench.MH</span> <span class="op">&lt;-</span> <span class="fu">Benchmark</span><span class="op">(</span><span class="va">est.bb.new</span>, <span class="va">national</span>, </span></span>
<span class="r-in"><span>  weight.region <span class="op">=</span> <span class="va">weight.region</span>, </span></span>
<span class="r-in"><span>  estVar <span class="op">=</span> <span class="st">"est"</span>, sdVar <span class="op">=</span> <span class="st">"sd"</span>, timeVar <span class="op">=</span> <span class="st">"years"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"MH"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="va">national</span></span></span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">before</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">after</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">weight.region</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb.new</span><span class="op">$</span><span class="va">overall</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sub</span>, <span class="va">weights</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">est.bb.bench.MH</span><span class="op">$</span><span class="va">overall</span>, <span class="va">years</span> <span class="op">==</span> <span class="va">national</span><span class="op">$</span><span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sub.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sub.bench</span>, <span class="va">weights</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">compare</span><span class="op">$</span><span class="va">before</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">proportion</span> <span class="op">*</span> <span class="va">sub</span><span class="op">$</span><span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sub.bench</span><span class="op">$</span><span class="va">proportion</span> <span class="op">*</span> <span class="va">sub.bench</span><span class="op">$</span><span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span>, <span class="va">compare</span><span class="op">$</span><span class="va">after</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"External national estimates"</span>, </span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"Weighted posterior median after benchmarking"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Sanity check: weighted average of area medians"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">est</span>, <span class="va">compare</span><span class="op">$</span><span class="va">before</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before benchmarking"</span>, <span class="st">"After benchmarking"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##  ------------------------------------------ ##</span></span></span>
<span class="r-in"><span><span class="co">##     Benchmarking with smoothDirect output</span></span></span>
<span class="r-in"><span><span class="co">##  ------------------------------------------ ##</span></span></span>
<span class="r-in"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">DemoData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># obtain direct estimates</span></span></span>
<span class="r-in"><span><span class="va">data_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="getDirectList.html">getDirectList</a></span><span class="op">(</span>births <span class="op">=</span> <span class="va">DemoData</span>, years <span class="op">=</span> <span class="va">years</span>,</span></span>
<span class="r-in"><span>                        regionVar <span class="op">=</span> <span class="st">"region"</span>,  timeVar <span class="op">=</span> <span class="st">"time"</span>, clusterVar <span class="op">=</span> <span class="st">"~clustid+id"</span>,</span></span>
<span class="r-in"><span>                        ageVar <span class="op">=</span> <span class="st">"age"</span>, weightsVar <span class="op">=</span> <span class="st">"weights"</span>, geo.recode <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregateSurvey.html">aggregateSurvey</a></span><span class="op">(</span><span class="va">data_multi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#  subnational model</span></span></span>
<span class="r-in"><span><span class="va">years.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">years</span>, <span class="st">"15-19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="smoothDirect.html">smoothDirect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, Amat <span class="op">=</span> <span class="va">DemoMap</span><span class="op">$</span><span class="va">Amat</span>,</span></span>
<span class="r-in"><span>                 year.label <span class="op">=</span> <span class="va">years.all</span>, year.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1985</span>, <span class="fl">2019</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 time.model <span class="op">=</span> <span class="st">"rw2"</span>, m <span class="op">=</span> <span class="fl">5</span>, type.st <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out2a</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSmoothed.html">getSmoothed</a></span><span class="op">(</span><span class="va">fit2</span>, joint <span class="op">=</span> <span class="cn">TRUE</span>, nsim <span class="op">=</span> <span class="fl">1e5</span>, save.draws <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Benchmarking for yearly estimates</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">region</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">region</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             years <span class="op">=</span> <span class="fl">1985</span><span class="op">:</span><span class="fl">2019</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span><span class="op">$</span><span class="va">proportion</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="co"># construct a simple national estimates</span></span></span>
<span class="r-in"><span><span class="va">national</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>years <span class="op">=</span> <span class="fl">1985</span><span class="op">:</span><span class="fl">2019</span>,</span></span>
<span class="r-in"><span>                       est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.15</span>, length <span class="op">=</span> <span class="fl">35</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">0.03</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Benchmarking to national estimates on the yearly scale</span></span></span>
<span class="r-in"><span><span class="va">out2b</span> <span class="op">&lt;-</span> <span class="fu">Benchmark</span><span class="op">(</span><span class="va">out2a</span>, <span class="va">national</span>, weight.region <span class="op">=</span> <span class="va">weight.region</span>,</span></span>
<span class="r-in"><span>                          estVar <span class="op">=</span> <span class="st">"est"</span>, sdVar <span class="op">=</span> <span class="st">"sd"</span>, timeVar <span class="op">=</span> <span class="st">"years"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2a</span><span class="op">$</span><span class="va">overall</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2b</span><span class="op">$</span><span class="va">overall</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine the point estimate and compare with the benchmark values</span></span></span>
<span class="r-in"><span><span class="va">national.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">~</span> <span class="va">years</span>, </span></span>
<span class="r-in"><span>   data <span class="op">=</span> <span class="va">out2a</span><span class="op">$</span><span class="va">overall</span><span class="op">[</span><span class="va">out2a</span><span class="op">$</span><span class="va">overall</span><span class="op">$</span><span class="va">is.yearly</span>, <span class="op">]</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">national.est.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">~</span> <span class="va">years</span>, </span></span>
<span class="r-in"><span>   data <span class="op">=</span> <span class="va">out2b</span><span class="op">$</span><span class="va">overall</span><span class="op">[</span><span class="va">out2b</span><span class="op">$</span><span class="va">overall</span><span class="op">$</span><span class="va">is.yearly</span>, <span class="op">]</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est</span><span class="op">$</span><span class="va">mean</span>,  </span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est</span><span class="op">$</span><span class="va">mean</span>, <span class="va">national.est.bench</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est</span><span class="op">$</span><span class="va">mean</span>, <span class="va">national.est.bench</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"External national estimates"</span>, </span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"Weighted posterior median after benchmarking"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Sanity check: weighted average of area means"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est.bench</span><span class="op">$</span><span class="va">mean</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before benchmarking"</span>, <span class="st">"After benchmarking"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Benchmarking for period estimates</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">region</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">region</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             years <span class="op">=</span> <span class="va">years.all</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weight.region</span><span class="op">$</span><span class="va">proportion</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="co"># construct a simple national estimates</span></span></span>
<span class="r-in"><span><span class="va">national</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>years <span class="op">=</span> <span class="va">years.all</span>,</span></span>
<span class="r-in"><span>                       est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.15</span>, len <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Benchmarking to national estimates on the period scale</span></span></span>
<span class="r-in"><span><span class="va">out2c</span> <span class="op">&lt;-</span> <span class="fu">Benchmark</span><span class="op">(</span><span class="va">out2a</span>, <span class="va">national</span>, weight.region <span class="op">=</span> <span class="va">weight.region</span>,</span></span>
<span class="r-in"><span>                          estVar <span class="op">=</span> <span class="st">"est"</span>, sdVar <span class="op">=</span> <span class="st">"sd"</span>, timeVar <span class="op">=</span> <span class="st">"years"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2a</span><span class="op">$</span><span class="va">overall</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2c</span><span class="op">$</span><span class="va">overall</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine the point estimate and compare with the benchmark values</span></span></span>
<span class="r-in"><span><span class="va">national.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">~</span> <span class="va">years</span>, </span></span>
<span class="r-in"><span>      data <span class="op">=</span> <span class="va">out2a</span><span class="op">$</span><span class="va">overall</span><span class="op">[</span><span class="op">!</span><span class="va">out2a</span><span class="op">$</span><span class="va">overall</span><span class="op">$</span><span class="va">is.yearly</span>, <span class="op">]</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">national.est.bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">~</span> <span class="va">years</span>, </span></span>
<span class="r-in"><span>      data <span class="op">=</span> <span class="va">out2c</span><span class="op">$</span><span class="va">overall</span><span class="op">[</span><span class="op">!</span><span class="va">out2b</span><span class="op">$</span><span class="va">overall</span><span class="op">$</span><span class="va">is.yearly</span>, <span class="op">]</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est</span><span class="op">$</span><span class="va">mean</span>,  </span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est</span><span class="op">$</span><span class="va">mean</span>, <span class="va">national.est.bench</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est</span><span class="op">$</span><span class="va">mean</span>, <span class="va">national.est.bench</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"External national estimates"</span>, </span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"Weighted posterior median after benchmarking"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Sanity check: weighted average of area means"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">national</span><span class="op">$</span><span class="va">est</span>, <span class="va">national.est.bench</span><span class="op">$</span><span class="va">mean</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before benchmarking"</span>, <span class="st">"After benchmarking"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zehang R Li, Bryan D Martin, Yuan Hsiao, Jessica Godwin, John Paige, Peter Gao, Jon Wakefield, Samuel J Clark, Geir-Arne Fuglstad, Andrea Riebler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

